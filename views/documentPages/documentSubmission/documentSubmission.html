<!-- views\documentPages\documentSubmission\documentSubmission.html -->
<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Nộp phiếu</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <link
      rel="stylesheet"
      href="documentPages/documentSubmission/documentSubmission.css"
    />
  </head>
  <body>
    <div class="container">
      <h2>Nộp phiếu mới</h2>
      <form
        id="submit-form"
        action="/submitDocument"
        method="POST"
        enctype="multipart/form-data"
      >
        <label for="title">Loại phiếu</label>
        <select name="title" id="title-dropdown" required>
          <option value="">Chọn mẫu phiếu</option>
          <option value="Project Proposal Document">
            Phiếu đề nghị mở dự án
          </option>
          <option value="Proposal Document">Phiếu đề xuất</option>
          <option value="Purchasing Document">Phiếu mua hàng</option>
          <option value="Delivery Document">Phiếu xuất kho</option>
          <option value="Payment Document">Phiếu thanh toán</option>
          <option value="Advance Payment Document">Phiếu tạm ứng</option>
          <option value="Advance Payment Reclaim Document">
            Phiếu thu lại tạm ứng
          </option>
        </select>

        <!-- Content fields for Generic Document -->
        <div id="content-fields">
          <label for="contentName">Tên nội dung</label>
          <input type="text" name="contentName" required />
          <label for="contentText">Nội dung</label>
          <textarea name="contentText" rows="5" required></textarea>
        </div>

        <button type="button" id="add-content-btn">Thêm nội dung</button><br />

        <label for="file">Đính kèm tệp:</label>
        <input type="file" name="file" id="file" />

        <!-- Dropdown for appending approved documents, only visible for Generic Document -->
        <div id="append-approved-documents-section" style="display: none">
          <label for="approvedDocumentsDropdown">Kèm phiếu đã duyệt</label>
          <select id="approvedDocumentsDropdown" name="approvedDocuments">
            <option value="">Chọn một phiếu đã duyệt</option>
          </select>
        </div>

        <!-- Fields for selecting and previewing approved proposal document -->
        <div id="approved-proposal-section" style="display: none">
          <label for="approvedProposals">Chọn phiếu đề xuất đã duyệt</label>
          <div id="proposal-selections">
            <div class="proposal-entry"></div>
          </div>
          <button type="button" onclick="addProposalEntry()">
            Thêm phiếu đề xuất
          </button>
          <div id="proposalPreviews"></div>
        </div>

        <!-- Dropdown for selecting Purchasing Document to append -->
        <div id="append-purchasing-documents-section" style="display: none">
          <label for="purchasingDocumentsDropdown">
            Chọn phiếu mua hàng để kèm theo
          </label>
          <select id="purchasingDocumentsDropdown">
            <option value="">Chọn phiếu mua hàng để kèm theo</option>
            <!-- Options populated dynamically -->
          </select>
          <button type="button" id="add-purchasing-document-btn">
            Thêm phiếu mua hàng kèm theo
          </button>
        </div>

        <!-- List of appended purchasing documents -->
        <div id="appendedPurchasingDocumentsList">
          <ul id="purchasingDocumentsList"></ul>
        </div>

        <!-- Preview of the selected Purchasing Document -->
        <div id="purchasingDocumentPreview" style="display: none">
          <h3>Xem trước phiếu mua hàng đi kèm</h3>
          <p><strong>Thông tin sản phẩm:</strong></p>
          <div id="productDetails"></div>
          <div id="appendedContentDetails"></div>
        </div>

        <!-- Approvers selection -->
        <label for="approvers">Chọn người phê duyệt</label>
        <div id="approver-selection"></div>

        <button type="submit">Nộp phiếu</button><br />
        <a href="/documentMain">Trở về</a><br />
      </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="documentPages/documentSubmission/documentSubmission.js?v=1.0"></script>
  </body>
</html>
